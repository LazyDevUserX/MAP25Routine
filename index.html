<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unmesh Medical Admission Program-2025 | Syllabus Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Identity Services -->
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #888; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        .custom-checkbox:checked {
            background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
            background-color: #2563eb;
            border-color: #2563eb;
        }
        details > summary { list-style: none; }
        details > summary::-webkit-details-marker { display: none; }
        #progress-widget, #progress-heading, #progress-text, #controls-container, #progress-bar-container {
            transition: all 0.3s ease-in-out;
        }
        #controls-container { overflow: hidden; }
        #progress-widget.scrolled {
            padding: 0.75rem 1.5rem;
            border-radius: 0 0 1.5rem 1.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        #progress-widget.scrolled #progress-heading, #progress-widget.scrolled #progress-text { font-size: 0.875rem; }
        #progress-widget.scrolled #progress-bar-container { height: 0.5rem; }
        #progress-widget.scrolled #controls-container {
            max-height: 0;
            opacity: 0;
            margin-top: 0;
            pointer-events: none;
        }
        /* Spinner for loading state */
        .loader {
            border: 4px solid #f3f3f3;
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="container mx-auto p-4 md:p-8 max-w-5xl">
        <header class="text-center mb-8 bg-white p-6 rounded-2xl shadow-md border border-gray-200">
            <h1 class="text-2xl md:text-4xl font-bold text-blue-700">Unmesh Medical Admission Program-2025</h1>
            <p class="text-gray-600 mt-2 text-lg">Interactive Syllabus Tracker</p>
        </header>

        <!-- Auth Section -->
        <div id="auth-container" class="text-center mb-8 bg-white p-6 rounded-2xl shadow-md border border-gray-200">
            <h2 id="auth-heading" class="text-xl font-bold text-gray-700 mb-4">Sign In to Sync Your Progress</h2>
            <p id="auth-p" class="text-gray-600 mb-4">Sign in with your Google account to save your progress and access it from any device.</p>
            <div id="google-signin-btn" class="inline-block"></div>
        </div>
        
        <!-- Loading/Syncing State -->
        <div id="loading-container" class="hidden text-center mb-8 bg-white p-6 rounded-2xl shadow-md border border-gray-200">
            <h2 class="text-xl font-bold text-gray-700 mb-4">Syncing Your Progress...</h2>
            <div class="loader"></div>
            <p class="text-gray-600">Please wait while we fetch your saved data.</p>
        </div>

        <!-- User Info Display (shown after login) -->
        <div id="user-info" class="hidden text-center mb-8 bg-white p-6 rounded-2xl shadow-md border border-gray-200">
            <p class="text-lg text-gray-700">Welcome, <span id="user-name" class="font-bold"></span>!</p>
            <button id="signout-btn" class="mt-2 text-sm text-blue-600 hover:underline">Sign Out</button>
        </div>


        <div id="progress-and-syllabus" class="hidden">
            <div class="sticky top-0 z-10 mb-8">
                <div id="progress-widget" class="bg-white p-6 rounded-2xl shadow-md border border-gray-200">
                    <div class="flex justify-between items-center mb-3">
                        <h2 id="progress-heading" class="text-lg font-semibold">Your Progress</h2>
                        <span id="progress-text" class="text-lg font-bold text-blue-700">0%</span>
                    </div>
                    <div id="progress-bar-container" class="w-full bg-gray-200 rounded-full h-4">
                        <div id="progress-bar" class="bg-blue-600 h-full rounded-full transition-all duration-500" style="width: 0%"></div>
                    </div>
                    <div id="controls-container" class="mt-6 flex flex-col sm:flex-row gap-4">
                        <input type="text" id="searchInput" placeholder="ЁЯФО Search for a topic..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none transition">
                        <button id="resetBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-6 rounded-lg transition-transform transform hover:scale-105">Reset Progress</button>
                    </div>
                </div>
            </div>
            <main id="syllabus-container" class="space-y-6"></main>
        </div>

        <footer class="text-center mt-12 text-gray-500">
            <p>&copy; 2025 Unmesh Medical & Dental Admission Care, Savar. Good luck with your preparation!</p>
        </footer>
    </div>

    <script>
        // --- CONFIGURATION ---
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbwhk9fUo_97zefctLSb-dVHhJin7jGFa2IfX9xZNyJ6ouEn0OZH8Gy_3lrToJ8LMCgL/exec';
        const GOOGLE_CLIENT_ID = '18826900841-c4acnsq9n5bvrbd7dg82kk7f03tfrrmu.apps.googleusercontent.com';
        // ---------------------

        const syllabusData = {
            "Biology (B)": { "B-01": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзк : ржорж╛ржиржм рж╢рж╛рж░рзАрж░рждрждрзНрждрзНржм : рж░ржХрзНржд ржУ рж╕ржЮрзНржЪрж╛рж▓ржи (рж╣рзГрзОржкрж┐ржгрзНржбрзЗрж░ ржЖржЧрзЗ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ ржкрж░рж┐ржЪрж┐рждрж┐ (ржнрзМржЧрзЛрж▓рж┐ржХ ржЕржмрж╕рзНржерж╛ржи, ржЖржпрж╝рждржи, рж╕рзАржорж╛ржирзНржд, ржЫрж┐ржЯржорж╣рж▓, ржЬрж╛рждрзАржпрж╝ ржмрж┐рж╖ржпрж╝рж╛ржмрж▓рж┐)"], "B-02": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзй : ржорж╛ржиржм рж╢рж╛рж░рзАрж░рждрждрзНрждрзНржм : ржкрж░рж┐ржкрж╛ржХ ржУ рж╢рзЛрж╖ржг (ржЖржирзНрждрзНрж░рж┐ржХ ржЧрзНрж░ржирзНржерж┐ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржкрж╛ржирж┐ рж╕ржорзНржкржж (ржмржЩрзНржЧрзЛржкрж╕рж╛ржЧрж░, рж╕ржорзБржжрзНрж░ рж╕рзИржХржд, ржжрзНржмрзАржк, ржиржж-ржиржжрзА, ржкрж╛ржирж┐ ржмржгрзНржЯржи ржЪрзБржХрзНрждрж┐, рж╕рзЗржЪ ржкрзНрж░ржХрж▓рзНржк, ржмрж╛ржБржз ржУ ржмржирзНржпрж╛ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг, ржкрж╛ржирж┐ рж╢рзЛржзржирж╛ржЧрж╛рж░, ржкрзНрж░рж╛ржХрзГрждрж┐ржХ ржжрзБрж░рзНржпрзЛржЧ)"], "B-03": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзи : ржХрзЛрж╖ ржмрж┐ржнрж╛ржЬржи, рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзй : ржХрзЛрж╖ рж░рж╕рж╛ржпрж╝ржи (ржХрж╛рж░рзНржмрзЛрж╣рж╛ржЗржбрзНрж░рзЗржЯ)", "GK: ржкрж╛ржХрж┐рж╕рзНрждрж╛ржи ржЖржорж▓рзЗ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзй : ржХрзЛрж╖ рж░рж╕рж╛ржпрж╝ржи (ржПржорж┐ржирзЛ ржПрж╕рж┐ржб, ржкрзНрж░рзЛржЯрж┐ржи, рж▓рж┐ржкрж┐ржб, ржПржиржЬрж╛ржЗржо)", "English: Parts of Speech Identification, Appropriate Preposition (B)"], "B-04": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз : ржХрзЛрж╖ ржУ ржПрж░ ржЧржаржи (ржХрзЛрж╖ ржЧрж╣рзНржмрж░ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╢рж┐ржХрзНрж╖рж╛, рж╕рзНржмрж╛рж╕рзНржерзНржп ржУ ржЬржирж╕ржВржЦрзНржпрж╛", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз : ржХрзЛрж╖ ржУ ржПрж░ ржЧржаржи (ржирж┐ржЙржХрзНрж▓рж┐ржпрж╝рж╛рж╕ ржерзЗржХрзЗ рж╢рзЗрж╖ ржкрж░рзНржпржирзНржд)", "English: Sentence & Its Classification, Transformation of Sentence"], "B-05": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзо : ржорж╛ржиржм рж╢рж╛рж░рзАрж░рждрждрзНрждрзНржм : рж╕ржоржирзНржмржпрж╝ ржУ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг (рж╕рзНржирж╛ржпрж╝рзБржмрж┐ржХ рж╕ржоржирзНржмржпрж╝)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕ржВржмрж┐ржзрж╛ржи ржУ рж░рж╛ржЬржирзИрждрж┐ржХ ржмрзНржпржмрж╕рзНржерж╛ (ржЖржЗржи ржУ ржмрж┐ржЪрж╛рж░ ржмрж┐ржнрж╛ржЧ, ржмрж┐ржнрж┐ржирзНржи ржХржорж┐рж╢ржи)", "Part 2: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз : ржкрзНрж░рж╛ржгрж┐рж░ ржмрж┐ржнрж┐ржирзНржирждрж╛ ржУ рж╢рзНрж░рзЗржгрж┐ржмрж┐ржирзНржпрж╛рж╕", "English: Tense and Its Identification, Sequence of Tense, Synonym & Antonym (E, F)"], "B-06": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзо : ржорж╛ржиржм рж╢рж╛рж░рзАрж░рждрждрзНрждрзНржм : рж╕ржоржирзНржмржпрж╝ ржУ ржирж┐ржпрж╝ржирзНрждрзНрж░ржг (ржЪрзЛржЦ, ржХрж╛ржи, рж░рж╛рж╕рж╛ржпрж╝ржирж┐ржХ рж╕ржоржирзНржмржпрж╝)", "GK: ржЧржгржорж╛ржзрзНржпржо, рж╢рж┐рж▓рзНржк ржУ рж╕ржВрж╕рзНржХрзГрждрж┐ (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржмрж┐ржЦрзНржпрж╛ржд ржмрзНржпржХрзНрждрж┐ржмрж░рзНржЧ, ржРрждрж┐рж╣рж╛рж╕рж┐ржХ рж╕рзНржерж╛ржи ржУ ржжрж░рзНрж╢ржирзАржпрж╝ рж╕рзНржерж╛ржкржирж╛)", "Part 2: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзл : ржорж╛ржиржм рж╢рж╛рж░рзАрж░рждрждрзНрждрзНржм : рж╢рзНржмрж╕ржи ржУ рж╢рзНржмрж╛рж╕ржХрзНрж░рж┐ржпрж╝рж╛", "English: Right Form of Verbs, Causative Verb, Subjunctive"] },
            "Chemistry (C)": { "C-01": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзи: ржЧрзБржгржЧржд рж░рж╕рж╛ржпрж╝ржи (ржЗрж▓рзЗржХржЯрзНрж░ржи ржмрж┐ржирзНржпрж╛рж╕рзЗрж░ ржЖржЧ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ ржкрж░рж┐ржЪрж┐рждрж┐ (ржнрзВ-ржкрзНрж░ржХрзГрждрж┐, ржкрж╛рж╣рж╛ржбрж╝-ржкрж░рзНржмржд, ржЙржкрждрзНржпржХрж╛, ржЬрж▓ржкрзНрж░ржкрж╛ржд, ржЭрж░рзНржгрж╛, рж╣рзНрж░ржж, ржЪрж░, ржмрж┐рж▓, рж╣рж╛ржУржбрж╝-ржмрж╛ржУржбрж╝, ржнрзМржЧрзЛрж▓рж┐ржХ ржЙржкржирж╛ржо)", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзи: ржЧрзБржгржЧржд рж░рж╕рж╛ржпрж╝ржи (ржЗрж▓рзЗржХржЯрзНрж░ржи ржмрж┐ржирзНржпрж╛рж╕ ржерзЗржХрзЗ ржжрзНрж░рж╛ржмрзНржпрждрж╛рж░ ржЖржЧ ржкрж░рзНржпржирзНржд)", "English: Number Gender, Pronoun, Appropriate Preposition (A)"], "C-02": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзй: ржорзМрж▓рзЗрж░ ржкрж░рзНржпрж╛ржпрж╝ржмрзГрждрзНржд ржзрж░рзНржо ржУ рж░рж╛рж╕рж╛ржпрж╝ржирж┐ржХ ржмржирзНржзржи (ржкрж░рзНржпрж╛ржпрж╝ рж╕рж╛рж░ржгрж┐, s-ржмрзНрж▓ржХ, p-ржмрзНрж▓╨║)", "GK: ржкрзНрж░рж╛ржЪрзАржи ржУ ржоржзрзНржпржпрзБржЧрзАржпрж╝ ржмрж╛ржВрж▓рж╛рж░ ржЗрждрж┐рж╣рж╛рж╕", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзй: ржорзМрж▓рзЗрж░ ржкрж░рзНржпрж╛ржпрж╝ржмрзГрждрзНржд ржзрж░рзНржо ржУ рж░рж╛рж╕рж╛ржпрж╝ржирж┐ржХ ржмржирзНржзржи (d-ржмрзНрж▓ржХ, f-ржмрзНрж▓╨║, ржкрж░рзНржпрж╛ржпрж╝ржмрзГрждрзНржд ржзрж░рзНржо)", "English: Gerund, Participle & Verbal Noun, Conjugation of Verbs, Synonym & Antonym (B)"], "C-03": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзи: ржЧрзБржгржЧржд рж░рж╕рж╛ржпрж╝ржи (ржжрзНрж░рж╛ржмрзНржпрждрж╛ ржерзЗржХрзЗ рж╢рзЗрж╖ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржорзБржХрзНрждрж┐ржпрзБржжрзНржз (ржЕржЧрзНржирж┐ржЭрж░рж╛ ржорж╛рж░рзНржЪ, ржорзБржЬрж┐ржмржиржЧрж░ рж╕рж░ржХрж╛рж░, ржорзБржХрзНрждрж┐ржпрзБржжрзНржзрзЗрж░ рж░ржгржХрзМрж╢рж▓, ржЧржгрж╣рждрзНржпрж╛ ржУ ржмрзБржжрзНржзрж┐ржЬрзАржмрзА рж╣рждрзНржпрж╛ржХрж╛ржгрзНржб, ржкрж╛ржХ ржмрж╛рж╣рж┐ржирзАрж░ ржЖрждрзНржорж╕ржорж░рзНржкржг, ржмрж┐рж╢рзНржмржЬржиржоржд ржУ ржЧржгржорж╛ржзрзНржпржорзЗрж░ ржнрзВржорж┐ржХрж╛)", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзй: ржорзМрж▓рзЗрж░ ржкрж░рзНржпрж╛ржпрж╝ржмрзГрждрзНржд ржзрж░рзНржо ржУ рж░рж╛рж╕рж╛ржпрж╝ржирж┐ржХ ржмржирзНржзржи (рж░рж╛рж╕рж╛ржпрж╝ржирж┐ржХ ржмржирзНржзржи)", "English: Transformation of Parts of Speech, Synonym & Antonym (C)"], "C-04": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз: ржкрж░рж┐ржмрзЗрж╢ рж░рж╕рж╛ржпрж╝ржи", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЕрж░рзНржержирзАрждрж┐, рж╢рж┐рж▓рзНржк ржУ ржмрж╛ржгрж┐ржЬрзНржп", "Part 2: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз: ржкрж░рж┐ржмрзЗрж╢ рж░рж╕рж╛ржпрж╝ржи (Continued)", "English: Voice, Synonym & Antonym (D)"], "C-05": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзй: ржкрж░рж┐ржорж╛ржгржЧржд рж░рж╕рж╛ржпрж╝ржи", "GK: ржмрж┐рж╢рзНржмрж╛ржЩрзНржЧржирзЗ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢", "Part 2: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзл: ржЕрж░рзНржержирзИрждрж┐ржХ рж░рж╕рж╛ржпрж╝ржи", "English: Subject-Verb Agreement, Appropriate Preposition (H-L)"], "C-06": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзк: рж░рж╛рж╕рж╛ржпрж╝ржирж┐ржХ ржкрж░рж┐ржмрж░рзНрждржи (ржЧрзНрж░рж┐ржи ржХрзЗржорж┐рж╕рзНржЯрзНрж░рж┐, ржЙржнржорзБржЦрзА ржмрж┐ржХрзНрж░рж┐ржпрж╝рж╛, ржкрзНрж░ржнрж╛ржмржХ, рж╕рж╛ржорзНржпрж╛ржмрж╕рзНржерж╛, Kp, Kc, ржкрж╛ржирж┐рж░ ржЖржпрж╝ржирж┐ржХ ржЧрзБржгржлрж▓)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ рж╕ржорзНржкрж░рзНржХрж┐ржд ржЕржирзНржпрж╛ржирзНржп рждржерзНржпрж╛ржмрж▓рж┐ (ржпрзЛржЧрж╛ржпрзЛржЧ ржмрзНржпржмрж╕рзНржерж╛ ржУ рждржерзНржпржкрзНрж░ржпрзБржХрзНрждрж┐, ржкрзНрж░рждрж┐рж░ржХрзНрж╖рж╛ ржУ рж╕рж╢рж╕рзНрждрзНрж░ ржмрж╛рж╣рж┐ржирзА, ржкржжржХ ржУ ржкрзБрж░рж╕рзНржХрж╛рж░)", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз: рж▓рзНржпрж╛ржмрж░рзЗржЯрж░рж┐рж░ ржирж┐рж░рж╛ржкржж ржмрзНржпржмрж╣рж╛рж░", "English: Parallelism, Redundancy, Dangling Modifier, Embedded Question, Commonly Misused Words"] },
            "Physics (P)": { "P-01": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзи : ржнрзЗржХрзНржЯрж░", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕ржорзНржкржж (ржорж╛ржЯрж┐, ржХрзГрж╖рж┐ржЬ рж╕ржорзНржкржж, ржмржиржЬ рж╕ржорзНржкржж, ржЬрзНржмрж╛рж▓рж╛ржирж┐, ржмрж┐ржжрзНржпрзБрзОржмрзНржпржмрж╕рзНржерж╛, ржЦржирж┐ржЬрж╕ржорзНржкржж, ржорзОрж╕рзНржп ржУ ржкрзНрж░рж╛ржгрж┐рж╕ржорзНржкржж)", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзк : ржирж┐ржЙржЯржирж┐ржпрж╝рж╛ржи ржмрж▓ржмрж┐ржжрзНржпрж╛", "English: Adjective, Degree of Comparison, Article"], "P-02": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзо : ржкрж░рзНржпрж╛ржпрж╝ржмрзГрждрзНржд ржЧрждрж┐, рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзп : рждрж░ржЩрзНржЧ (ржЕржЧрзНрж░ржЧрж╛ржорзА рждрж░ржЩрзНржЧрзЗрж░ ржЖржЧ ржкрж░рзНржпржирзНржд)", "GK: ржЗржЙрж░рзЛржкрзАржпрж╝ржжрзЗрж░ ржЖржЧржоржи ржУ ржмрзНрж░рж┐ржЯрж┐рж╢ рж╢рж╛рж╕ржи", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзп : рждрж░ржЩрзНржЧ (ржЕржЧрзНрж░ржЧрж╛ржорзА рждрж░ржЩрзНржЧ ржерзЗржХрзЗ рж╢рзЗрж╖ ржкрж░рзНржпржирзНржд)", "English: Preposition, Conjunction, Linker & Interjection, Suffix & Prefix"], "P-03": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз : рждрж╛ржкржЧрждрж┐ржмрж┐ржжрзНржпрж╛ (ржХрж╛рж░рзНржирзЛрж░ ржЪржХрзНрж░рзЗрж░ ржЖржЧ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржорзБржХрзНрждрж┐ржпрзБржжрзНржз (ржЦрзЗрждрж╛ржм, рж╕рзНржмрзАржХрзГрждрж┐, ржЧрзНрж░ржирзНрже, ржЧрж╛ржи, ржЪрж▓ржЪрзНржЪрж┐рждрзНрж░, ржнрж╛рж╕рзНржХрж░рзНржп, ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржмрзНржпржХрзНрждрж┐ржмрж░рзНржЧ, ржкрж░ржмрж░рзНрждрзА ржШржЯржирж╛ ржкрзНрж░ржмрж╛рж╣)", "Part 2: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз : рждрж╛ржкржЧрждрж┐ржмрж┐ржжрзНржпрж╛ (ржХрж╛рж░рзНржирзЛрж░ ржЪржХрзНрж░ ржерзЗржХрзЗ рж╢рзЗрж╖ ржкрж░рзНржпржирзНржд), рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рззрзз : ржЬрзНржпрзЛрждрж┐рж░рзНржмрж┐ржЬрзНржЮрж╛ржи", "English: Phrases & Clauses, Appropriate Preposition (C, D)"], "P-04": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзк : рждржбрж╝рж┐рзО ржкрзНрж░ржмрж╛рж╣рзЗрж░ ржЪрзМржорзНржмржХ ржХрзНрж░рж┐ржпрж╝рж╛ ржУ ржЪрзБржорзНржмржХрждрзНржм (ржЪрзМржорзНржмржХ ржкржжрж╛рж░рзНржерзЗрж░ рж╢рзНрж░рзЗржгрж┐ржмрж┐ржнрж╛ржЧрзЗрж░ ржЖржЧ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕ржВржмрж┐ржзрж╛ржи ржУ рж░рж╛ржЬржирзИрждрж┐ржХ ржмрзНржпржмрж╕рзНржерж╛ (рж╕ржВржмрж┐ржзрж╛ржи, ржкржжрж╕ржорзВрж╣, ржоржирзНрждрзНрж░ржгрж╛рж▓ржпрж╝, рж╕рзНржерж╛ржирзАржпрж╝ рж╕рж░ржХрж╛рж░, ржмрж┐ржнрж╛ржЧ ржУ ржЬрзЗрж▓рж╛, ржЬрж╛рждрзАржпрж╝ рж╕ржВрж╕ржж)", "Part 2: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзк : рждржбрж╝рж┐рзО ржкрзНрж░ржмрж╛рж╣рзЗрж░ ржЪрзМржорзНржмржХ ржХрзНрж░рж┐ржпрж╝рж╛ ржУ ржЪрзБржорзНржмржХрждрзНржм (рж╢рзНрж░рзЗржгрж┐ржмрж┐ржнрж╛ржЧ ржерзЗржХрзЗ рж╢рзЗрж╖ ржкрж░рзНржпржирзНржд), рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзл : рждржбрж╝рж┐рзОржЪрзМржорзНржмржХ ржЖржмрзЗрж╢ ржУ ржкрж░рж┐ржмрж░рзНрждрзА ржкрзНрж░ржмрж╛рж╣", "English: Narration, Appropriate Preposition (E-G)"], "P-05": ["Part 1: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзз : ржнрзМрждржЬржЧрзО ржУ ржкрж░рж┐ржорж╛ржк, рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзм : ржорж╣рж╛ржХрж░рзНрж╖ ржУ ржЕржнрж┐ржХрж░рзНрж╖", "GK: ржЧржгржорж╛ржзрзНржпржо, рж╢рж┐рж▓рзНржк ржУ рж╕ржВрж╕рзНржХрзГрждрж┐ (ржмрж┐ржЦрзНржпрж╛ржд ржкрзНрж░рждрж┐рж╖рзНржарж╛ржи, рж╢рж┐рж▓рзНржк, рж╕ржВрж╕рзНржХрзГрждрж┐, рж╕ржВржмрж╛ржжржкрждрзНрж░, рж╕рж╛рж╣рж┐рждрзНржп)", "Part 2: рззржо ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзн : ржкржжрж╛рж░рзНржерзЗрж░ ржЧрж╛ржаржирж┐ржХ ржзрж░рзНржо", "English: Conditionals, Modal Auxiliaries, Synonym & Antonym (G, H)"], "P-06": ["Part 1: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзм : ржЬрзНржпрж╛ржорж┐рждрж┐ржХ ржЖрж▓рзЛржХржмрж┐ржЬрзНржЮрж╛ржи (ржкрзНрж░рж┐ржЬржорзЗ ржЖрж▓рзЛрж░ ржкрзНрж░рждрж┐рж╕рж░ржг ржУ ржмрж┐ржЪрзНржЫрзБрж░ржгрзЗрж░ ржЖржЧ ржкрж░рзНржпржирзНржд)", "GK: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ рж╕ржорзНржкрж░рзНржХрж┐ржд ржЕржирзНржпрж╛ржирзНржп рждржерзНржпрж╛ржмрж▓рж┐ (ржХрзНрж░рзАржбрж╝рж╛ржЬржЧрзО, ржжрж┐ржмрж╕, ржШржЯржирж╛, ржкрзНрж░ржержо-ржмрзГрж╣рждрзНрждржо-ржХрзНрж╖рзБржжрзНрж░рждржо, ржкрзВрж░рзНржгрж░рзВржк), рж╕рж╛ржорзНржкрзНрж░рждрж┐ржХ ржмрж┐рж╖ржпрж╝рж╛ржмрж▓рж┐", "Part 2: рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рзжрзм : ржЬрзНржпрж╛ржорж┐рждрж┐ржХ ржЖрж▓рзЛржХржмрж┐ржЬрзНржЮрж╛ржи (ржкрзНрж░рждрж┐рж╕рж░ржг ржУ ржмрж┐ржЪрзНржЫрзБрж░ржг ржерзЗржХрзЗ рж╢рзЗрж╖ ржкрж░рзНржпржирзНржд), рзиржпрж╝ ржкрждрзНрж░ ржЕржзрзНржпрж╛ржпрж╝-рззрзж : рж╕рзЗржорж┐ржХржирзНржбрж╛ржХрзНржЯрж░ ржУ ржЗрж▓рзЗржХржЯрзНрж░ржирж┐ржХрзНрж╕", "English: Grammatical Error"] },
            "English Marathon (E)": { "E-01": ["Part 1: Noun & Its Classification, Noun & Determiners, Number, Appropriate preposition (A-C), Spelling (A-C), Group Verb (A-C), One-word substitution (Study, Science, Marriage, Literary)", "Part 2: Gender, Preposition & Its Classification, Uses of Some Prepositions, Conjunction, Synonym & Antonym (A-C), Idiom & Phrase (A-C), Proverb (A-C)"], "E-02": ["Part 1: Pronoun & Its Classification, Uses of Pronoun, Linkers & Connectors, Interjection, Appropriate preposition (D-G), Spelling (D-G), Group Verb (D-G), One-word substitution (Personal related, Religious, Specialist)", "Part 2: Embedded Question, Tag question, Parallelism, Punctuation, Redundancy, Dangling modifier, Synonym & Antonym (D-G), Idiom & Phrase (D-G), Proverb (D-G), Analogy (Synonym-Animal and Flesh)"], "E-03": ["Part 1: Verb & Its Classification, Gerund, Participle & Verbal Noun, Causative Verb, Subjunctive, Conjugation of Verbs, Uses of Modal Auxiliaries, Translation, Appropriate preposition (H-K), Spelling (H-K), Group Verb (H-K), One-word substitution (Animal, Omni), Foreign words (Part -01)", "Part 2: Sub-verb agreement, Right form of verb, Sequence of Tense, Conditionals, Some Highly Important Rules, Synonym & Antonym (H-K), Idiom & Phrase (H-K), Proverb (H-K) Analogy (Collective Noun: Common Noun тАУ Controlling Elements)"], "E-04": ["Part 1: Adjective & Degree of Comparison, Article, Adverb & Inversion, Appropriate preposition (L-R), Spelling (L-R), Group Verb (L-R), One-word substitution (Kill, Place, Govt.), Foreign words (Part -02)", "Part 2: Affirmative & Negative Agreement, Narration, Suffix & Prefix, Same Word but Different Parts of Speech, Transformation of Parts of Speech, Identification of Parts of Speech, Synonym & Antonym (L-R), Idiom & Phrase (L-R), Proverb (L-R)"] },
            "General Knowledge Marathon (GK)": { "GK-01": ["Part 1: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ ржкрж░рж┐ржЪрж┐рждрж┐, ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ рж╕ржорзНржкржж, ржкрж╛ржирж┐ рж╕ржорзНржкржж", "Part 2: ржкрзНрж░рж╛ржЪрзАржи ржУ ржоржзрзНржпржпрзБржЧрзАржпрж╝ ржмрж╛ржВрж▓рж╛рж░ ржЗрждрж┐рж╣рж╛рж╕, ржЗржЙрж░рзЛржкрзАржпрж╝ржжрзЗрж░ ржЖржЧржоржи ржУ ржмрзНрж░рж┐ржЯрж┐рж╢ рж╢рж╛рж╕ржи, рж╕рж╛ржорзНржкрзНрж░рждрж┐ржХ ржмрж┐рж╖ржпрж╝рж╛ржмрж▓рж┐ (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢)"], "GK-02": ["Part 1: ржкрж╛ржХрж┐рж╕рзНрждрж╛ржи ржЖржорж▓рзЗ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢, ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржорзБржХрзНрждрж┐ржпрзБржжрзНржз (ржЕржЧрзНржирж┐ржЭрж░рж╛ ржорж╛рж░рзНржЪ, ржорзБржЬрж┐ржмржиржЧрж░ рж╕рж░ржХрж╛рж░, рж░ржгржХрзМрж╢рж▓, ржЧржгрж╣рждрзНржпрж╛, ржЖрждрзНржорж╕ржорж░рзНржкржг)", "Part 2: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржорзБржХрзНрждрж┐ржпрзБржжрзНржз (ржмрж┐рж╢рзНржмржЬржиржоржд, ржЦрзЗрждрж╛ржм, рж╕рзНржмрзАржХрзГрждрж┐, ржЧрзНрж░ржирзНрже, ржЧрж╛ржи, ржЪрж▓ржЪрзНржЪрж┐рждрзНрж░, ржнрж╛рж╕рзНржХрж░рзНржп, ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржмрзНржпржХрзНрждрж┐ржмрж░рзНржЧ, ржкрж░ржмрж░рзНрждрзА ржШржЯржирж╛ ржкрзНрж░ржмрж╛рж╣), рж╢рж┐ржХрзНрж╖рж╛, рж╕рзНржмрж╛рж╕рзНржерзНржп ржУ ржЬржирж╕ржВржЦрзНржпрж╛, рж╕рж╛ржорзНржкрзНрж░рждрж┐ржХ ржмрж┐рж╖ржпрж╝рж╛ржмрж▓рж┐ (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢)"], "GK-03": ["Part 1: ржмрж╛ржВрж▓рж╛ржжрзЗрж╢рзЗрж░ ржЕрж░рзНржержирзАрждрж┐, рж╢рж┐рж▓рзНржк ржУ ржмрж╛ржгрж┐ржЬрзНржп, рж╕ржВржмрж┐ржзрж╛ржи ржУ рж░рж╛ржЬржирзИрждрж┐ржХ ржмрзНржпржмрж╕рзНржерж╛, ржмрж┐рж╢рзНржмрж╛ржЩрзНржЧржирзЗ ржмрж╛ржВрж▓рж╛ржжрзЗрж╢", "Part 2: ржЧржгржорж╛ржзрзНржпржо, рж╢рж┐рж▓рзНржк ржУ рж╕ржВрж╕рзНржХрзГрждрж┐, ржмрж╛ржВрж▓рж╛ржжрзЗрж╢ рж╕ржорзНржкрж░рзНржХрж┐ржд ржЕржирзНржпрж╛ржирзНржп рждржерзНржпрж╛ржмрж▓рж┐, рж╕рж╛ржорзНржкрзНрж░рждрж┐ржХ ржмрж┐рж╖ржпрж╝рж╛ржмрж▓рж┐ (ржмрж╛ржВрж▓рж╛ржжрзЗрж╢)"] }
        };

        const container = document.getElementById('syllabus-container');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const searchInput = document.getElementById('searchInput');
        const resetBtn = document.getElementById('resetBtn');
        const progressWidget = document.getElementById('progress-widget');
        const authContainer = document.getElementById('auth-container');
        const loadingContainer = document.getElementById('loading-container');
        const progressAndSyllabus = document.getElementById('progress-and-syllabus');
        const googleSigninBtn = document.getElementById('google-signin-btn');
        const userInfo = document.getElementById('user-info');
        const userNameEl = document.getElementById('user-name');
        
        let totalItems = 0;
        let currentUser = null;

        // --- AUTH LOGIC ---
        function handleCredentialResponse(response) {
            const data = parseJwt(response.credential);
            currentUser = { id: data.sub, name: data.name, email: data.email };
            localStorage.setItem("currentUser", JSON.stringify(currentUser));
            showLoadingAndFetchProgress();
        }

        function parseJwt(token) {
            const base64Url = token.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            const jsonPayload = decodeURIComponent(atob(base64).split('').map(c =>
                '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));
            return JSON.parse(jsonPayload);
        }
        
        function showLoadingAndFetchProgress() {
            authContainer.style.display = "none";
            userInfo.style.display = "none";
            loadingContainer.style.display = "block";
            loadProgress();
        }

        function showAppUI() {
            userNameEl.textContent = currentUser.name;
            loadingContainer.style.display = "none";
            userInfo.style.display = "block";
            progressAndSyllabus.style.display = "block";
        }

        function showLoginUI() {
            authContainer.style.display = "block";
            loadingContainer.style.display = "none";
            userInfo.style.display = "none";
            progressAndSyllabus.style.display = "none";
        }

        window.onload = function () {
            renderSyllabus();
            setupEventListeners();
            
            const savedUser = localStorage.getItem("currentUser");
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                showLoadingAndFetchProgress();
            }

            google.accounts.id.initialize({
                client_id: GOOGLE_CLIENT_ID,
                callback: handleCredentialResponse,
            });

            google.accounts.id.renderButton(
                document.getElementById("google-signin-btn"),
                { theme: "outline", size: "large", type: "standard" }
            );
        };

        document.getElementById("signout-btn").addEventListener("click", () => {
            currentUser = null;
            localStorage.removeItem("currentUser");
            google.accounts.id.disableAutoSelect();
            showLoginUI();
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            updateProgress();
        });

        // --- PROGRESS & SYLLABUS LOGIC ---
        function renderSyllabus() {
            container.innerHTML = '';
            totalItems = 0;
            Object.keys(syllabusData).forEach(subject => {
                const subjectId = subject.replace(/\s+/g, '-').toLowerCase();
                const section = document.createElement('details');
                section.className = 'bg-white rounded-2xl shadow-md border border-gray-200 overflow-hidden';
                section.open = true;
                const summary = document.createElement('summary');
                summary.className = 'p-5 cursor-pointer flex justify-between items-center bg-gray-100 hover:bg-gray-200 transition';
                summary.innerHTML = `<h2 class="text-xl font-bold text-gray-700">${subject}</h2><svg class="w-6 h-6 text-gray-600 transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>`;
                const contentDiv = document.createElement('div');
                contentDiv.className = 'p-5';
                const subSections = syllabusData[subject];
                Object.keys(subSections).forEach(subSectionTitle => {
                    const subSectionDiv = document.createElement('div');
                    subSectionDiv.className = 'mb-4';
                    const title = document.createElement('h3');
                    title.className = 'text-lg font-semibold text-blue-700 mb-2 border-b-2 border-blue-200 pb-1';
                    title.textContent = subSectionTitle;
                    subSectionDiv.appendChild(title);
                    const topics = subSections[subSectionTitle];
                    topics.forEach(topic => {
                        totalItems++;
                        const topicId = `${subjectId}-${subSectionTitle}-${totalItems}`;
                        const topicDiv = document.createElement('div');
                        topicDiv.className = 'flex items-start my-3 topic-item';
                        topicDiv.innerHTML = `<input type="checkbox" id="${topicId}" class="custom-checkbox h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 mt-1 flex-shrink-0"><label for="${topicId}" class="ml-3 text-gray-700">${topic}</label>`;
                        subSectionDiv.appendChild(topicDiv);
                    });
                    contentDiv.appendChild(subSectionDiv);
                });
                section.appendChild(summary);
                section.appendChild(contentDiv);
                container.appendChild(section);
                section.addEventListener('toggle', () => {
                    const icon = summary.querySelector('svg');
                    icon.classList.toggle('rotate-[-90deg]', !section.open);
                });
            });
        }

        function updateProgress() {
            const checkedItems = document.querySelectorAll('input[type="checkbox"]:checked').length;
            const percentage = totalItems > 0 ? Math.round((checkedItems / totalItems) * 100) : 0;
            progressBar.style.width = `${percentage}%`;
            progressText.textContent = `${percentage}%`;
        }
        
        async function saveProgress() {
            if (!currentUser) return;
            const checkedIds = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.id);
            // Save to local storage immediately for instant UI feedback on next reload
            localStorage.setItem(`progress_${currentUser.id}`, JSON.stringify(checkedIds));
            
            // Send to server in the background
            try {
                await fetch(WEB_APP_URL, {
                    method: 'POST',
                    mode: 'no-cors', 
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ userId: currentUser.id, checkedIds: checkedIds })
                });
            } catch (error) {
                console.error('Error saving progress to server:', error);
            }
        }

        async function loadProgress() {
            if (!currentUser) return;

            // Step 1: Immediately load from local storage for a snappy UI
            const localProgress = localStorage.getItem(`progress_${currentUser.id}`);
            if (localProgress) {
                const checkedIds = JSON.parse(localProgress);
                 checkedIds.forEach(id => {
                    const checkbox = document.getElementById(id);
                    if (checkbox) checkbox.checked = true;
                });
                updateProgress();
            }

            // Step 2: Fetch the latest data from the server in the background
            try {
                const response = await fetch(`${WEB_APP_URL}?userId=${currentUser.id}`);
                const data = await response.json();
                
                // Reset checkboxes before applying server state
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);

                if (data.checkedIds && data.checkedIds.length > 0) {
                    const serverCheckedIds = data.checkedIds.split(',');
                    serverCheckedIds.forEach(id => {
                        const checkbox = document.getElementById(id);
                        if (checkbox) checkbox.checked = true;
                    });
                    // Update local storage with the latest server data
                    localStorage.setItem(`progress_${currentUser.id}`, JSON.stringify(serverCheckedIds));
                } else {
                    // If server has no data, clear local storage too
                    localStorage.removeItem(`progress_${currentUser.id}`);
                }

            } catch (error) {
                console.error('Error loading progress from server:', error);
                // If server fails, the user still sees their locally saved data
            } finally {
                updateProgress();
                showAppUI(); // Show the main app UI after loading is complete
            }
        }

        function filterSyllabus() {
            const query = searchInput.value.toLowerCase();
            document.querySelectorAll('.topic-item').forEach(item => {
                const label = item.querySelector('label').textContent.toLowerCase();
                item.style.display = label.includes(query) ? 'flex' : 'none';
            });
        }

        function setupEventListeners() {
            window.addEventListener('scroll', () => {
                progressWidget.classList.toggle('scrolled', window.scrollY > 50);
            });
            container.addEventListener('change', (e) => {
                if (e.target.type === 'checkbox') {
                    updateProgress();
                    saveProgress(); // This now saves to local storage instantly and sends to server
                }
            });
            searchInput.addEventListener('input', filterSyllabus);
            resetBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to reset your progress? This will clear it on all devices.')) {
                    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                    updateProgress();
                    saveProgress();
                }
            });
        }
    </script>
</body>
</html>
