<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Syllabus Progress Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .chapter { margin-bottom: 15px; padding: 10px; border: 1px solid #ccc; border-radius: 6px; }
    .chapter-title { font-weight: bold; margin-bottom: 5px; }
    #progress-container { margin: 20px 0; width: 100%; background: #eee; border-radius: 6px; overflow: hidden; }
    #progress-bar { height: 20px; background: #4caf50; width: 0%; transition: width 0.3s; }
    #progress-text { margin-top: 5px; font-weight: bold; }
    #user-info { display: none; margin-bottom: 15px; }
    #syllabus-container input { margin-right: 8px; }
    button { padding: 6px 12px; margin-top: 10px; }
  </style>
</head>
<body>
  <h1>ðŸ“˜ Syllabus Progress Tracker</h1>

  <!-- Google Sign-in -->
  <div id="auth-container">
    <h2 id="auth-heading">Sign In to Sync Your Progress</h2>
    <p id="auth-p">Sign in with your Google account to save your progress.</p>
    <div id="google-signin-btn"></div>
  </div>

  <!-- User Info -->
  <div id="user-info">
    <p>ðŸ‘¤ Signed in as <span id="user-name"></span></p>
    <button id="signout-btn">Sign Out</button>
  </div>

  <!-- Progress -->
  <div id="progress-and-syllabus" style="display:none;">
    <div id="progress-container">
      <div id="progress-bar"></div>
    </div>
    <div id="progress-text">0%</div>
    <button id="resetBtn">Reset Progress</button>
    <hr>
    <div id="syllabus-container"></div>
  </div>

<script>
  // --- CONFIG ---
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwhk9fUo_97zefctLSb-dVHhJin7jGFa2IfX9xZNyJ6ouEn0OZH8Gy_3lrToJ8LMCgL/exec";
  const GOOGLE_CLIENT_ID = "18826900841-c4acnsq9n5bvrbd7dg82kk7f03tfrrmu.apps.googleusercontent.com";

  let totalItems = 0;
  let currentUser = null;

  // --- Syllabus Data ---
  const syllabusData = { /* ðŸ”½ Your full syllabus JSON pasted here ðŸ”½ */
    "Biology (B)": {
      "B-01": ["Part 1: à§¨à¦¯à¦¼ à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§ª : à¦®à¦¾à¦¨à¦¬ à¦¶à¦¾à¦°à§€à¦°à¦¤à¦¤à§à¦¤à§à¦¬ : à¦°à¦•à§à¦¤ à¦“ à¦¸à¦žà§à¦šà¦¾à¦²à¦¨ (à¦¹à§ƒà§Žà¦ªà¦¿à¦£à§à¦¡à§‡à¦° à¦†à¦—à§‡ à¦ªà¦°à§à¦¯à¦¨à§à¦¤)", "GK: à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶ à¦ªà¦°à¦¿à¦šà¦¿à¦¤à¦¿ (à¦­à§Œà¦—à§‹à¦²à¦¿à¦• à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨, à¦†à¦¯à¦¼à¦¤à¦¨, à¦¸à§€à¦®à¦¾à¦¨à§à¦¤, à¦›à¦¿à¦Ÿà¦®à¦¹à¦², à¦œà¦¾à¦¤à§€à¦¯à¦¼ à¦¬à¦¿à¦·à¦¯à¦¼à¦¾à¦¬à¦²à¦¿)"],
      "B-02": ["Part 1: à§¨à¦¯à¦¼ à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§© : à¦®à¦¾à¦¨à¦¬ à¦¶à¦¾à¦°à§€à¦°à¦¤à¦¤à§à¦¤à§à¦¬ : à¦ªà¦°à¦¿à¦ªà¦¾à¦• à¦“ à¦¶à§‹à¦·à¦£ (à¦†à¦¨à§à¦¤à§à¦°à¦¿à¦• à¦—à§à¦°à¦¨à§à¦¥à¦¿ à¦ªà¦°à§à¦¯à¦¨à§à¦¤)", "GK: à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶à§‡à¦° à¦ªà¦¾à¦¨à¦¿ à¦¸à¦®à§à¦ªà¦¦ (à¦¬à¦™à§à¦—à§‹à¦ªà¦¸à¦¾à¦—à¦°, à¦¸à¦®à§à¦¦à§à¦° à¦¸à§ˆà¦•à¦¤, à¦¦à§à¦¬à§€à¦ª, à¦¨à¦¦-à¦¨à¦¦à§€, à¦ªà¦¾à¦¨à¦¿ à¦¬à¦£à§à¦Ÿà¦¨ à¦šà§à¦•à§à¦¤à¦¿, à¦¸à§‡à¦š à¦ªà§à¦°à¦•à¦²à§à¦ª, à¦¬à¦¾à¦à¦§ à¦“ à¦¬à¦¨à§à¦¯à¦¾ à¦¨à¦¿à¦¯à¦¼à¦¨à§à¦¤à§à¦°à¦£, à¦ªà¦¾à¦¨à¦¿ à¦¶à§‹à¦§à¦¨à¦¾à¦—à¦¾à¦°, à¦ªà§à¦°à¦¾à¦•à§ƒà¦¤à¦¿à¦• à¦¦à§à¦°à§à¦¯à§‹à¦—)"],
      "B-03": ["Part 1: à§§à¦® à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§¨ : à¦•à§‹à¦· à¦¬à¦¿à¦­à¦¾à¦œà¦¨, à§§à¦® à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§© : à¦•à§‹à¦· à¦°à¦¸à¦¾à¦¯à¦¼à¦¨ (à¦•à¦¾à¦°à§à¦¬à§‹à¦¹à¦¾à¦‡à¦¡à§à¦°à§‡à¦Ÿ)", "GK: à¦ªà¦¾à¦•à¦¿à¦¸à§à¦¤à¦¾à¦¨ à¦†à¦®à¦²à§‡ à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶", "Part 2: à§§à¦® à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§© : à¦•à§‹à¦· à¦°à¦¸à¦¾à¦¯à¦¼à¦¨ (à¦à¦®à¦¿à¦¨à§‹ à¦à¦¸à¦¿à¦¡, à¦ªà§à¦°à§‹à¦Ÿà¦¿à¦¨, à¦²à¦¿à¦ªà¦¿à¦¡, à¦à¦¨à¦œà¦¾à¦‡à¦®)", "English: Parts of Speech Identification, Appropriate Preposition (B)"],
      "B-04": ["Part 1: à§§à¦® à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§§ : à¦•à§‹à¦· à¦“ à¦à¦° à¦—à¦ à¦¨ (à¦•à§‹à¦· à¦—à¦¹à§à¦¬à¦° à¦ªà¦°à§à¦¯à¦¨à§à¦¤)", "GK: à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶à§‡à¦° à¦¶à¦¿à¦•à§à¦·à¦¾, à¦¸à§à¦¬à¦¾à¦¸à§à¦¥à§à¦¯ à¦“ à¦œà¦¨à¦¸à¦‚à¦–à§à¦¯à¦¾", "Part 2: à§§à¦® à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§§ : à¦•à§‹à¦· à¦“ à¦à¦° à¦—à¦ à¦¨ (à¦¨à¦¿à¦‰à¦•à§à¦²à¦¿à¦¯à¦¼à¦¾à¦¸ à¦¥à§‡à¦•à§‡ à¦¶à§‡à¦· à¦ªà¦°à§à¦¯à¦¨à§à¦¤)", "English: Sentence & Its Classification, Transformation of Sentence"],
      "B-05": ["Part 1: à§¨à¦¯à¦¼ à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§® : à¦®à¦¾à¦¨à¦¬ à¦¶à¦¾à¦°à§€à¦°à¦¤à¦¤à§à¦¤à§à¦¬ : à¦¸à¦®à¦¨à§à¦¬à¦¯à¦¼ à¦“ à¦¨à¦¿à¦¯à¦¼à¦¨à§à¦¤à§à¦°à¦£ (à¦¸à§à¦¨à¦¾à¦¯à¦¼à§à¦¬à¦¿à¦• à¦¸à¦®à¦¨à§à¦¬à¦¯à¦¼)", "GK: à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶à§‡à¦° à¦¸à¦‚à¦¬à¦¿à¦§à¦¾à¦¨ à¦“ à¦°à¦¾à¦œà¦¨à§ˆà¦¤à¦¿à¦• à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾ (à¦†à¦‡à¦¨ à¦“ à¦¬à¦¿à¦šà¦¾à¦° à¦¬à¦¿à¦­à¦¾à¦—, à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨ à¦•à¦®à¦¿à¦¶à¦¨)", "Part 2: à§¨à¦¯à¦¼ à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§§ : à¦ªà§à¦°à¦¾à¦£à¦¿à¦° à¦¬à¦¿à¦­à¦¿à¦¨à§à¦¨à¦¤à¦¾ à¦“ à¦¶à§à¦°à§‡à¦£à¦¿à¦¬à¦¿à¦¨à§à¦¯à¦¾à¦¸", "English: Tense and Its Identification, Sequence of Tense, Synonym & Antonym (E, F)"],
      "B-06": ["Part 1: à§¨à¦¯à¦¼ à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§® : à¦®à¦¾à¦¨à¦¬ à¦¶à¦¾à¦°à§€à¦°à¦¤à¦¤à§à¦¤à§à¦¬ : à¦¸à¦®à¦¨à§à¦¬à¦¯à¦¼ à¦“ à¦¨à¦¿à¦¯à¦¼à¦¨à§à¦¤à§à¦°à¦£ (à¦šà§‹à¦–, à¦•à¦¾à¦¨, à¦°à¦¾à¦¸à¦¾à¦¯à¦¼à¦¨à¦¿à¦• à¦¸à¦®à¦¨à§à¦¬à¦¯à¦¼)", "GK: à¦—à¦£à¦®à¦¾à¦§à§à¦¯à¦®, à¦¶à¦¿à¦²à§à¦ª à¦“ à¦¸à¦‚à¦¸à§à¦•à§ƒà¦¤à¦¿ (à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶à§‡à¦° à¦¬à¦¿à¦–à§à¦¯à¦¾à¦¤ à¦¬à§à¦¯à¦•à§à¦¤à¦¿à¦¬à¦°à§à¦—, à¦à¦¤à¦¿à¦¹à¦¾à¦¸à¦¿à¦• à¦¸à§à¦¥à¦¾à¦¨ à¦“ à¦¦à¦°à§à¦¶à¦¨à§€à¦¯à¦¼ à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾)", "Part 2: à§¨à¦¯à¦¼ à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§« : à¦®à¦¾à¦¨à¦¬ à¦¶à¦¾à¦°à§€à¦°à¦¤à¦¤à§à¦¤à§à¦¬ : à¦¶à§à¦¬à¦¸à¦¨ à¦“ à¦¶à§à¦¬à¦¾à¦¸à¦•à§à¦°à¦¿à¦¯à¦¼à¦¾", "English: Right Form of Verbs, Causative Verb, Subjunctive"]
    },
    "Chemistry (C)": {
      "C-01": ["Part 1: à§§à¦® à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§¨: à¦—à§à¦£à¦—à¦¤ à¦°à¦¸à¦¾à¦¯à¦¼à¦¨ (à¦‡à¦²à§‡à¦•à¦Ÿà§à¦°à¦¨ à¦¬à¦¿à¦¨à§à¦¯à¦¾à¦¸à§‡à¦° à¦†à¦— à¦ªà¦°à§à¦¯à¦¨à§à¦¤)", "GK: à¦¬à¦¾à¦‚à¦²à¦¾à¦¦à§‡à¦¶ à¦ªà¦°à¦¿à¦šà¦¿à¦¤à¦¿ (à¦­à§‚-à¦ªà§à¦°à¦•à§ƒà¦¤à¦¿, à¦ªà¦¾à¦¹à¦¾à¦¡à¦¼-à¦ªà¦°à§à¦¬à¦¤, à¦‰à¦ªà¦¤à§à¦¯à¦•à¦¾, à¦œà¦²à¦ªà§à¦°à¦ªà¦¾à¦¤, à¦à¦°à§à¦£à¦¾, à¦¹à§à¦°à¦¦, à¦šà¦°, à¦¬à¦¿à¦², à¦¹à¦¾à¦“à¦¡à¦¼-à¦¬à¦¾à¦“à¦¡à¦¼, à¦­à§Œà¦—à§‹à¦²à¦¿à¦• à¦‰à¦ªà¦¨à¦¾à¦®)", "Part 2: à§§à¦® à¦ªà¦¤à§à¦° à¦…à¦§à§à¦¯à¦¾à¦¯à¦¼-à§¦à§¨: à¦—à§à¦£à¦—à¦¤ à¦°à¦¸à¦¾à¦¯à¦¼à¦¨ (à¦‡à¦²à§‡à¦•à¦Ÿà§à¦°à¦¨ à¦¬à¦¿à¦¨à§à¦¯à¦¾à¦¸ à¦¥à§‡à¦•à§‡ à¦¦à§à¦°à¦¾à¦¬à§à¦¯à¦¤à¦¾à¦° à¦†à¦— à¦ªà¦°à§à¦¯à¦¨à§à¦¤)", "English: Number Gender, Pronoun, Appropriate Preposition (A)"]
      // ðŸ”½ Continue with Chemistry, Physics, English, GK data from your syllabus JSON ðŸ”½
    }
  };

  // --- AUTH LOGIC ---
  function handleCredentialResponse(response) {
    const data = parseJwt(response.credential);
    currentUser = { id: data.sub, name: data.name, email: data.email };
    localStorage.setItem("currentUser", JSON.stringify(currentUser));
    showUserUI();
    loadProgress();
  }

  function parseJwt(token) {
    const base64Url = token.split('.')[1];
    const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    const jsonPayload = decodeURIComponent(atob(base64).split('').map(c =>
      '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2)).join(''));
    return JSON.parse(jsonPayload);
  }

  function showUserUI() {
    document.getElementById("user-name").textContent = currentUser.name;
    document.getElementById("auth-container").style.display = "none";
    document.getElementById("user-info").style.display = "block";
    document.getElementById("progress-and-syllabus").style.display = "block";
  }

  function hideUserUI() {
    document.getElementById("auth-container").style.display = "block";
    document.getElementById("user-info").style.display = "none";
    document.getElementById("progress-and-syllabus").style.display = "none";
  }

  window.onload = function () {
    const saved = localStorage.getItem("currentUser");
    renderSyllabus();
    setupEventListeners();

    if (saved) {
      currentUser = JSON.parse(saved);
      showUserUI();
      loadProgress();
    }

    google.accounts.id.initialize({
      client_id: GOOGLE_CLIENT_ID,
      callback: handleCredentialResponse,
      auto_select: true
    });

    google.accounts.id.renderButton(
      document.getElementById("google-signin-btn"),
      { theme: "outline", size: "large" }
    );
  };

  document.getElementById("signout-btn").addEventListener("click", () => {
    currentUser = null;
    localStorage.removeItem("currentUser");
    google.accounts.id.disableAutoSelect();
    hideUserUI();
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    updateProgress();
  });

  // --- PROGRESS LOGIC ---
  function updateProgress() {
    const checkedItems = document.querySelectorAll('input[type="checkbox"]:checked').length;
    const percentage = totalItems > 0 ? Math.round((checkedItems / totalItems) * 100) : 0;
    document.getElementById("progress-bar").style.width = `${percentage}%`;
    document.getElementById("progress-text").textContent = `${percentage}%`;
  }

  async function saveProgress() {
    if (!currentUser) return;
    const checkedIds = Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map(cb => cb.id);
    try {
      await fetch(WEB_APP_URL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ userId: currentUser.id, checkedIds })
      });
    } catch (err) { console.error("Save error:", err); }
  }

  async function loadProgress() {
    if (!currentUser) return;
    document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    updateProgress();
    try {
      const res = await fetch(`${WEB_APP_URL}?userId=${currentUser.id}`);
      const data = await res.json();
      if (data.checkedIds) {
        data.checkedIds.split(",").forEach(id => {
          const cb = document.getElementById(id);
          if (cb) cb.checked = true;
        });
      }
      updateProgress();
    } catch (err) { console.error("Load error:", err); }
  }

  function setupEventListeners() {
    document.getElementById("syllabus-container").addEventListener("change", e => {
      if (e.target.type === "checkbox") {
        updateProgress();
        saveProgress();
      }
    });
    document.getElementById("resetBtn").addEventListener("click", () => {
      if (confirm("Reset all progress?")) {
        document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
        updateProgress();
        saveProgress();
      }
    });
  }

  // --- RENDER SYLLABUS ---
  function renderSyllabus() {
    const container = document.getElementById("syllabus-container");
    container.innerHTML = "";
    totalItems = 0;
    for (const subject in syllabusData) {
      const subjectDiv = document.createElement("div");
      subjectDiv.innerHTML = `<h2>${subject}</h2>`;
      for (const chapter in syllabusData[subject]) {
        const chapterDiv = document.createElement("div");
        chapterDiv.className = "chapter";
        chapterDiv.innerHTML = `<div class="chapter-title">${chapter}</div>`;
        syllabusData[subject][chapter].forEach((topic, idx) => {
          totalItems++;
          const id = `${chapter}-${idx}`;
          chapterDiv.innerHTML += `<label><input type="checkbox" id="${id}"> ${topic}</label><br>`;
        });
        subjectDiv.appendChild(chapterDiv);
      }
      container.appendChild(subjectDiv);
    }
  }
</script>
</body>
</html>
